{% extends 'template/template.j2.html' %}

{% block title %}
    {{ $t('sidebar.routeExample') }}
{% endblock %}

{% block content %}
<div class="my-6">
  <h3 class="text-xl font-semibold text-slate-800">{{ $t('webRouteExample.title') }}</h3>
  <div class="my-3 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-sm">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-slate-200">
        <thead class="bg-slate-50">
          <tr>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">#</th>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">{{ $t('webRouteExample.path') }}</th>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">{{ $t('webRouteExample.type') }}</th>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">{{ $t('webRouteExample.permissions') }}</th>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">{{ $t('webRouteExample.auth') }}</th>
            <th class="px-4 py-2 text-left text-sm font-semibold text-slate-700">{{ $t('webRouteExample.controller') }}</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-200">
          {% for route in routes %}
          <tr class="odd:bg-white even:bg-slate-50">
            <td class="px-4 py-2 align-top text-sm text-slate-700">{{ loop.index }}</td>
            <td class="px-4 py-2 align-top text-sm">
              <a class="text-primary-700 hover:underline" href="{{ route.fullPath }}">
                [{{ route.method }}]
                {{ route.fullPath }}
              </a>
            </td>
            <td class="px-4 py-2 align-top text-sm text-slate-700">{{ route.type }}</td>
            <td class="px-4 py-2 align-top text-sm text-slate-700">{{ route.permissions }}</td>
            <td class="px-4 py-2 align-top text-sm text-slate-700">{{ route.hasAuth | string }}</td>
            <td class="px-4 py-2 align-top text-sm text-slate-700">{{ route.controller }}{{ route.index }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="my-3 overflow-hidden rounded-lg border border-slate-200 bg-white shadow-sm">
    <ul class="divide-y divide-slate-200">
      <li class="px-4 py-3">
        <div class="flex flex-col gap-1 md:flex-row md:items-center md:gap-3">
          <b class="md:w-48">{{ $t('webRouteExample.router') }}</b>
          <i class="text-primary-600">example/lib/route/web_route.dart</i>
        </div>
      </li>
    </ul>
    <div class="p-4">
      <pre dir="ltr"  class="prettyprint border-0">
        <code class="language-dart">
import 'package:webapp/wa_route.dart';
import '../controllers/home_controller.dart';

Future<List<WebRoute>> getWebRoute(WebRequest rq) async {
  final homeController = HomeController(rq);
  final includeController = IncludeJsController(rq);

  var paths = [
    WebRoute(
      path: 'ws',
      methods: RequestMethods.ALL,
      rq: rq,
      index: homeController.socket,
    ),
    WebRoute(
      path: 'app/includes.js',
      methods: RequestMethods.ALL,
      rq: rq,
      index: includeController.index,
    ),
    WebRoute(
      path: 'example',
      rq: rq,
      index: () => rq.redirect('/'),
      children: [
        WebRoute(
          path: '/form',
          methods: RequestMethods.ALL,
          rq: rq,
          index: homeController.exampleForm,
        ),
        WebRoute(
          path: '/cookie',
          methods: RequestMethods.ONLY_GET,
          rq: rq,
          index: homeController.exampleCookie,
        ),
        WebRoute(
          path: '/cookie',
          methods: RequestMethods.ONLY_POST,
          rq: rq,
          index: homeController.exampleAddCookie,
        ),
        WebRoute(
          path: '/cookie',
          methods: RequestMethods.ONLY_GET,
          rq: rq,
          index: homeController.exampleAddCookie,
        ),
        WebRoute(
          path: '/route',
          methods: RequestMethods.ONLY_GET,
          rq: rq,
          index: homeController.exampleRoute,
        ),
        WebRoute(
          path: '/socket',
          methods: RequestMethods.ONLY_GET,
          rq: rq,
          index: homeController.exampleSocket,
        ),
        WebRoute(
          path: '/email',
          methods: RequestMethods.ONLY_GET,
          rq: rq,
          index: homeController.exampleEmail,
        ),
        WebRoute(
          path: '/email',
          methods: RequestMethods.ONLY_POST,
          rq: rq,
          index: homeController.exampleEmailSend,
        ),
      ],
    ),
    WebRoute(
      path: 'info',
      extraPath: ['api/info'],
      rq: rq,
      index: homeController.info,
    ),
  ];

  return [
    WebRoute(
      path: '/',
      rq: rq,
      methods: RequestMethods.ALL,
      controller: homeController,
      children: [
        ...paths,
        WebRoute(
          path: 'fa/*',
          extraPath: [
            'en/*',
            'nl/*',
          ],
          rq: rq,
          index: homeController.changeLanguage,
        )
      ],
    ),
  ];
}
        </code>
      </pre>
    </div>
  </div>
</div>
{% endblock %}
